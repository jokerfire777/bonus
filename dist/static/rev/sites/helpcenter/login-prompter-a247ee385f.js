"use strict";!function(n,e,t){function o(n,e){var o=e.attr("href");!t.user.loggedIn&&v(o)?(j.forEach(function(n){n.isSelected(e)&&I.push(n.onClicked)}),E=e,y=n):j.forEach(function(t){t.isSelected(e)&&t.onClicked(n,e,"noAction",null)})}function r(n,e){j.push({isSelected:n,onClicked:e})}function i(n){return n.is(w)||n.is(b)||n.is(C)}function c(){if(!A)if("M"===ebates.stats.device)A=e(C);else{var n=e(w);n.length>0?A=n:(n=e(b),n.length>0&&(A=n))}return A}function a(n){var e=c();if(!e)throw new Error("No Sign In Link found");P=!0,L=e.attr("data-target-url")||"",e.attr("data-target-url",n),S=n,e.click()}function l(n){var e=c();if(!e)throw new Error("No Sign In Link found");P=!0,L=e.attr("href")||"";var o=t.param.add("targetpage",n,t.param.remove("targetpage",L));e.attr("href",o),S=n,e.click(),g(null,null,null,function(){window.location.href=o})}function u(n){"M"===ebates.stats.device?l(n):a(n)}function f(n,e){e&&I.push(e),P||D||u(n,e)}function d(){T||(I.forEach(function(n){n(y,E,"closed")}),I.length=0,P=!1,D=!1,h())}function h(){A&&A.attr("data-target-url",L)}function g(n,e,t,o){var r=I.length;if(r>0){var i=0;I.forEach(function(n){var c=!1;n(y,E,"success",function(){console.log("Done Called"+i),c||(console.log("Unique Done Called"+i),c=!0,++i===r&&(console.log("Done Call Finalized all listener done calls"),h(),o&&o()))},e,t)})}else h(),o&&o();I.length=0}function s(n,t){if(D=!0,T=!1,P){var o=e(ebates.UI.active.modal).find(".show-join-overlay");o.attr("data-target-url",S),o.on("click",function(){T=!0})}}function p(n,t){var o=A||e("<a href="+t+" />"),r=jQuery.Event("click");r.currentTarget=o[0],r.target=o[0],I.forEach(function(n){n(r,o,"noAction",null)}),I.length=0,n&&n(r,o,"noAction",null)}function v(n){var e=!1;if(n)for(var t=0;t<U.length;++t){var o=U[t];if(o(n)){e=!0;break}}return e}function m(n,e){return n&&!t.user.loggedIn&&v(n)?(f(n,e),!1):(n&&p(e),!0)}function k(){if(!t.user.loggedIn){var n=t.param.get(x,window.location.href),e=t.param.get(O,window.location.href)||"";n&&f(decodeURIComponent(e))}}if(t.helpcenter&&t.helpcenter.loginPrompter)throw new Error("Attempting to load Login Prompter more than once");var w="#login-modal",b='.show-join-overlay[data-click-action="Click Sign In"]',C='[data-click-action="Click Sign In"]',I=[],x="login",O="loginTo",A=void 0,E=void 0,y=void 0,S="",L="",P=!1,D=!1,T=!1,U=[function(n){return n.indexOf("help/missing-cash-back")>=0},function(n){return n.indexOf("help/track-cash-back")>=0},function(n){return n.indexOf("help/track-rebate")>=0},function(n){return n.indexOf("help/track-big-fat-check")>=0},function(n){return n.indexOf("help/generic-big-fat")>=0},function(n){return n.indexOf("help/raf-issue")>=0},function(n){return n.indexOf("help/track-my-welcome-bonus")>=0},function(n){return n.indexOf("help/event-track-welcome-bonus")>=0},function(n){return n.indexOf("help/track-welcome-bonus")>=0},function(n){return n.indexOf("/help/customer_care/bigFat")>=0}],j=[];!function(){if(!t.user.loggedIn&&v(window.location.href)){var n=window.location.href.replace(window.location.origin,"");window.location.replace("/help?"+x+"=true&"+O+"="+encodeURIComponent(n))}}(),e(document).ready(function(){k(),e("body").on("click","a",function(n){var t=e(n.currentTarget);if(!i(t)){o(n,t);var r=n.currentTarget.getAttribute("href");r&&!m(r)&&n.preventDefault()}})}),t.helpcenter=t.helpcenter||{},t.helpcenter.loginPrompter={triggerLoginPrompt:f,tryHighAuthPath:m,requiresHighAuth:v,addAuthAwareLinkCallBack:r},e(document).on("modal-closed",d),e(document).on("auth-form-success",g),e(document).on("auth-form-init-done",s)}(document,$,ebates);
//# sourceMappingURL=login-prompter-a247ee385f.js.map
