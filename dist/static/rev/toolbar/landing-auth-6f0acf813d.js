"use strict";!function(e,t){var a={view:"landing-su-form"},n={"landing-su-form":{param:"su",url:"ajax/landing/su.htm",page:"signup",title:"Sign Up",action:"SU"},"landing-si-form":{param:"si",url:"ajax/landing/si.htm",page:"signin",title:"Sign In",action:"SI"},"landing-fp-form":{param:"fp",url:"ajax/landing/fp.htm",page:"forgotPW",title:"Forgot Password",action:"FP"},"landing-fp-success":{param:"fs",url:"ajax/landing/fs.htm",page:"forgotPW/confirm",title:"Forgot Password - Confirm",action:"FP Confirm"}},s={su:"landing-su-form",si:"landing-si-form",fp:"landing-fp-form",fs:"landing-fp-success"},r="yes"===ebates.param.get("tb")||"toolbar"===ebates.param.get("sourceName"),i=e.getElementById("target-merchant"),o=ebates.stats.targetPage||(i?r?i.getAttribute("data-merchant-page-link"):"mall_ctrl.do"+ebates.param.remove("auth_type",location.search):"default.htm"),l={su:e.querySelector(".landing-auth-header .eb-su-link"),si:e.querySelector(".landing-auth-header .eb-si-link")},c=e.querySelector(".landing-landing-header"),d=e.querySelector(".landing-auth-container"),u=function(e,t){ebates.js.require(ebates.src.modal,function(){var s;if(location.search.indexOf("anon=allow")>-1){$.ajaxSetup({async:!0}),s=ebates.param.add("anon","allow",n[e].url);var r=i.getAttribute("data-merchant-page-link")+location.search;r=r.replace("&auth_type=si",""),"si"===n[e].param&&(r+="&auth_type=si"),s=ebates.param.add("targetpage",encodeURIComponent(r),s)}else s=ebates.param.add("targetpage",encodeURIComponent(o),n[e].url);ebates.stats.splitId&&(s=ebates.param.add("split_id",ebates.stats.splitId,s)),ebates.UI.modal('<span class="fa-spinner fa-pulse f-50 f-grn absolute h-v-centered ht-50 w-50"></span>',{bg:{use:!1},url:s,css:{files:["static/rev/toolbar/landing-auth.css"]},container:d,replace:!0,classes:{toAdd:[e,"op0"],toRemove:["fixed","border","border-grn-t-5"]}},{init:function(){var e=this.querySelector(".eb-modal-close");e&&e.parentNode.removeChild(e)},ajax:{done:function(){t&&t.bind(this)(),location.search.indexOf("anon=allow")>-1&&($.ajaxSetup({async:!1}),ebates.stats.targetPage=document.getElementById("target-merchant")?"/mall_ctrl.do"+location.search:"/",setTimeout(function(){var e=$(".eb-auth-form form input[name*=type]");e&&e.length&&e.val("anon-shopping")},100))}}}),/si/.test(n[e].param)?(l.su&&l.su.classList.remove("hide"),l.si.classList.add("hide")):(l.si.classList.remove("hide"),l.su&&l.su.classList.add("hide")),/su/.test(n[e].param)?c.classList.remove("hide"):c.classList.add("hide"),a.view=e,!t&&f.send.pageview()})},g=function(e){if(this.targetView||e.target.classList.contains("eb-auth-link")){var a=this.targetView||e.target.getAttribute("data-form-name"),s="su"===n[a].param?ebates.param.remove("auth_type",location.href):ebates.param.add("auth_type",n[a].param,location.href);e.preventDefault(),!this.targetView&&t.trigger("susi-event",["click",e.target.getAttribute("data-event")||"Nav"]),u(a),history.pushState({view:a},"",s)}},p=r?" - Button":"",m=i&&i.getAttribute("data-merchant-id"),f={category:"Light SUSI"+p,send:{event:function(e,a,n){var s=["send","event",f.category,e,a];n&&s.push({hitCallback:n}),t.trigger("stats",{data:s})},pageview:function(){var e=m||"success"===ebates.param.get("install")&&"install-success"+(ebates.user.loggedIn?"":"-anon")||"default",s={page:"virtual/"+f.category.replace(/(\s|\-)+\-*\s*/g,"-")+"/"+n[a.view].page+"/"+e,title:n[a.view].title};t.trigger("stats",{data:["send","pageview",s]})}}};if(u(s[ebates.param.get("auth_type")]||(e.body.classList.contains("r3-mode")?"landing-si-form":"landing-su-form")),e.body.addEventListener("click",g,!0),t.on("password-reset-success",g.bind({targetView:"landing-fp-success"})),ebates.js.require(ebates.src.form.fb),window.addEventListener("popstate",function(e){var t=e.state&&e.state.view||"landing-su-form";t!==a.view&&u(t)},!1),t.on("err-msg",".landing-auth-container form",function(e,n,s){if("INVALIDUSER"===n)return void t.trigger("password-reset-success");if(s){var r=function(){var e=this.querySelector(".auth-err");e&&(e.textContent=n,e.classList.remove("hide"))};u(a.view,r)}}),t.one("input",".auto-correct",function(){return ebates.js.require(ebates.src.emailCorrector.loader,function(){return ebates.loadMailCheck(".auto-correct")})}),t.on("susi-event",function(e,t,s,r){return f.send.event(n[a.view].action+" "+t,s,r||null)}),t.on("click","a.track-click-event",function(){var e=this;return t.trigger("susi-event",["click",this.getAttribute("data-event")||"Nav",function(){return location.href=e.getAttribute("href")}]),!1}),location.search.indexOf("anon=allow")>-1){var h=i.getAttribute("data-merchant-page-link").replace(/.com|\//g,"");h&&t.trigger("stats",{data:["send","event","Anon shopping","Signup Modal",h]})}}(document,$(document));
//# sourceMappingURL=landing-auth-6f0acf813d.js.map
