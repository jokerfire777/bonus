var ebates=ebates||{};ebates.loadOverlay=function(e){var a,t={bg:{use:!0,opacity:.8},scrollToTop:!0,css:{}},r=$.extend(!0,t,e),i=$("#skinny-join-form"),s=0,o=$("#backgroundPopup"),n=o.length?o.css({opacity:r.bg.opacity}):$('<div id="backgroundPopup" style="opacity:'+r.bg.opacity+';display:block;" class="hide"></div>'),l=$(".skinny-join-btn"),d=ebates.landingPageLabel||"",c=$("input[name='type']").not("#frmStoreSearch2 input[name='type']"),p={emailEmpty:"Please fill out this field.",passwordEmpty:"Your password must be at least 8 characters long.",emailInvalid:"Please enter a valid email address.",passwordInvalid:"Your password must be at least 8 characters long.",longPassword:"Your password cannot be longer than 128 characters.",captchaEmpty:"Please Enter the verification code."},u=function(e,a,t){return l.removeClass("disabled"),$(".error",i).remove(),a.append($("<div>").addClass("error "+t).html(e)),i.trigger("err-msg"),!0},h=function(){var e=$("#password",i).val(),a=jQuery.trim($("#email_address",i).val()),t=$("#passwd-field",i),r=$("#email-field",i),s=jQuery.trim($("#captcha",i).val()),o=$("#captcha-field",i);return a?ebates.regex.email.test(a)?e?e.length<6?(u(p.passwordInvalid,t,"invalid"),!1):e.length>128?(u(p.longPassword,t,"invalid"),!1):$("#captcha").length>0&&0==s.length?(u(p.captchaEmpty,o,"invalid"),!1):!($("#recaptcha",i).is(":visible")&&!grecaptcha.getResponse(ebates.recaptcha.ids.skinny))||($("#gcap-error").show(),!1):(u(p.passwordEmpty,t,"empty"),!1):(u(p.emailInvalid,r,"invalid"),!1):(u(p.emailEmpty,r,"empty"),!1)},m=function(){var e=jQuery.trim($(this).val()),a=$(this).hasClass("placeholder-wraped")?$(this).parent():$(this),t=i.find(".error.be-invalid");if(e&&i.find(".error").length)return t.length?void t.remove():a.siblings(".empty").length?void a.siblings(".empty").remove():void(($(this).hasClass("email-address")&&ebates.regex.email.test(e)||$(this).hasClass("password")&&e.length>=6&&e.length<=128)&&a.siblings(".error").remove())},v=function(){var e=window.location.port,a=window.location.hostname,t=("localhost"===a&&"http://"||"../https@")+a+(e&&":"+window.location.port)+i.attr("action");l.hasClass("disabled")||h()&&l.addClass("disabled")&&$.ajax(t,{type:"POST",data:i.serialize()+"&isAjax=true",error:function(){window.location.href="auth/getLogonForm.do"},success:function(e){var a=$("#email-field",i),t=($("#refer-field",i),$("#captcha-field",i));if(e&&"fail"===e.status){if($("#captcha").length>0&&getCaptcha(),$("#recaptcha").length>0&&(grecaptcha.reset(),$("#gcap-error").hide()),"Your account is currently unavailable. Please contact Customer Care for assistance."===e.message){return u("Your account is currently unavailable. Please <a href='help/customer_care/other.htm@cchelp=true'>Contact Member Services</a> for assistance.",a,"be-invalid"),!1}return e.message?(u(e.message,a,"be-invalid"),!1):e.message?(u(e.message,t,"be-invalid"),!1):(u(p.emailInvalid,a,""),!1)}if(e&&"success"===e.status){if("Oops. Please provide a valid email address for your friend. If no one referred you, please leave the field blank."===e.message)try{localStorage.setItem("invalid_referral_email","true")}catch(e){}if($(".show-join-overlay[data-redirect-url]").length&&$(".show-join-overlay[data-redirect-url]").data("redirect-url")){var r=decodeURIComponent($(".show-join-overlay[data-redirect-url]").data("redirect-url"));ebates.param.get("_csrf")?$.ajax({type:"GET",url:"/ajax/getCsrfParam.htm",dataType:"text"}).done(function(e){window.location.href=ebates.param.add("_csrf",e.trim(),r)}):window.location.href=r}else window.location.reload()}},xhrFields:{withCredentials:!0},crossDomain:!0})};i.on("keypress","input",function(e){13!==e.keyCode&&(s&&clearTimeout(s),s=setTimeout($.proxy(m,this),200))}),r.scrollToTop&&window.scrollTo(0,0),r.bg.use&&n.appendTo(".tablet-content-body").fadeIn(500).addClass("notcloseable"),$("#join-signup").css(r.css).prependTo(".tablet-content-body").fadeIn(500,function(){$(document).trigger("overlay-loaded")}).find("#email_address").focus().removeClass("inputblur"),d&&c.length&&c.val()!==d&&c.val(d+" - "+c.val()),a=c.length&&c.val()||"Skinny",jQuery.browser.msie&&jQuery.browser.version<=9&&i.attr("action","/saveNewUserInfos.do"),l.on("click",function(e){if(jQuery.browser.msie&&jQuery.browser.version<=9){if(l.hasClass("disabled"))return;h()&&l.addClass("disabled")&&i.submit()}else v()}),i.on("keypress",function(e){if(13===e.keyCode)if(jQuery.browser.msie&&jQuery.browser.version<=9){if(l.hasClass("disabled"))return;h()&&l.addClass("disabled")&&i.submit()}else v()}),$("#fb-join-button").click(function(){var e,t=window.location.protocol;return $("input[name='ebates.signup.promo']").is(":visible")?fbPromoValue=$("input[name='ebates.signup.promo']:checked","#join-signup-form").val():fbPromoValue="SUJOIN10-201503",fbsplitId=$("input[name='split_entry_id']").val(),e="https:"!==t?"http://":"../https@",linkWithFacebook&&linkWithFacebook($("meta[property='fb:app_id']").attr("content"),e+window.location.host+"/",$("meta[property='fb.app.redirect.url']").attr("content"),{type:a}),!1}),$("a#terms").on("click",function(){loadwindowterms("help/terms_and_conditions_popup.htm",$(this))}),$("a#privacy").on("click",function(){loadwindowprivacy("help/privacy_popup.htm",$(this))}),$("a.referrer").click(function(){$("li#refer").remove(),$("li#refer-field").show(),$("#referral_email_address").focus().removeClass("inputblur")}),$("a#disable").on("click",function(){$(document).trigger("stats",{data:["send","event","Overlays","Closed",a]}),$("#backgroundPopup, #join-signup").fadeOut("slow",function(){$("#join-signup").remove(),$(document).trigger("overlay-closed")})}),/(msie|trident)/i.test(navigator.userAgent)&&($("#join-signup :password, #join-signup #email_address, #join-signup #referral_email_address").not(".placeholder-wraped").wrap('<div class="placeholder-container relative"></div>').addClass("absolute placeholder-wraped"),$(".placeholder-container").each(function(){$(this).append('<div class="h-v-centered placeholder-div prox-r hide" unselectable="on">'+$("input",this).attr("placeholder")+"</div>")}),$(function(){$("input.placeholder-wraped").each(function(){""===$(this).val()&&$(this).next(".placeholder-div").removeClass("hide"),$(this).on("input keyup blur",function(){""!==$(this).val()?$(this).next(".placeholder-div").addClass("hide"):$(this).next(".placeholder-div").removeClass("hide")}),$(this).next(".placeholder-div").on("click",function(){$(this).prev("input").focus()})})}))};
//# sourceMappingURL=skinny-d91d74ee2d.js.map
