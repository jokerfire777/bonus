$.fn.carousel=function(d){var e={nav:{next:$("<a>").html("&#12297;"),prev:$("<a>").html("&#12296;"),keyboard:false},lazy:{src:"href"},times:{anim:550,next:false,delay:10,last:200},animation:{css:true,type:"fade"},counter:true,defaultSlide:"",scroll:"scroll-throttle",navigator:{use:false,cont:"<div>",item:"<span>",classes:{cont:"navigator",item:"nav-item",active:"active",transition:"fast-transition"}}},h=$.extend(true,e,d),g=$(window),a=(function(){var m=(document.body||document.documentElement).style,l,j=["Moz","webkit","Webkit","ms"],k="Transition";if(typeof m[k.toLowerCase()]==="string"){return true}for(l=0;l<j.length;l++){if(typeof m[j[l]+k]==="string"){return true}}return false})(),f=!($.browser.msie&&$.browser.version<10)&&(requestAnimationFrame||mozRequestAnimationFrame||webkitRequestAnimationFrame||msRequestAnimationFrame)||function(i){setTimeout(i,h.times.delay)},b="ontransitionend" in window&&"transitionend"||"onwebkittransitionend" in window&&"webkitTransitionEnd"||"transend",c=function(j){var i=g.scrollTop(),k=j.offset().top;return k+j.height()<i+g.height()&&k>i};return this.each(function(){var y,x=$(this),p,B={},m={permStop:false,isAuto:false,isAnimating:false,isForwarding:false},r={anim:h.times.anim},z,l=h.navigator&&h.navigator.use&&[],j,v=x.find("ul:first > li").addClass("hide"),s=v.width(),t={pre:[{left:s+"px"},{left:-s+"px"}],after:[{left:"-="+s},{left:"+="+s}]},u=function(){B={last:[x.attr("data-out-next")||""],next:[x.attr("data-in-next")||""]};B.last.push(x.attr("data-out-prev")||B.last[0]);B.next.push(x.attr("data-in-prev")||B.next[0])},o=function(i,D,C,E,w){i?D.detach().insertBefore(C):D.detach().insertBefore(E);D.addClass("hide").add(C).removeClass([B.last.join(" "),B.next.join(" "),"top-z-index"].join(" ")).css({transitionDuration:0+"ms"});w&&(w==="slide"&&D.css({left:0})||w==="fade"&&D.fadeIn(0));m.isAnimating=false;x.trigger("slide-done")},k=function(w){$("ul > li:eq("+w+") img",x).not(".loaded").each(function(){$(this).attr("src",$(this).attr("data-"+h.lazy.src)).addClass("loaded")})},q={css:function(i,C,w,E){var D=function(){o(i,C,w,E);w.off(b,D);return false};m.isAnimating=true;w.on(b,D);b==="transend"&&setTimeout(function(){w.trigger(b)},r.anim+h.times.delay);w.addClass(B.next[i]);B.next[i]&&!B.last[i]&&w.addClass("top-z-index");setTimeout(function(){w.add(C).css({transitionDuration:r.anim+"ms"});setTimeout(function(){f(function(){w.removeClass(B.next[i]);C.addClass(B.last[i])})},h.times.delay)},h.times.delay)},js:{slide:function(i,C,w,D){w.css(t.pre[i]).animate(t.after[i],r.anim);C.animate(t.after[i],r.anim,$.proxy(o,null,i,C,w,D,"slide"))},fade:function(i,C,w,D){C.fadeOut(r.anim,$.proxy(o,null,i,C,w,D,"fade"))}}},A=h.animation.css&&a&&q.css||q.js[h.animation.type]||q.js[h.animation.type],n=function(w,i){var D=x.find("ul:first > li"),E=D.last(),C=D.eq(w?0:-2);i!=="fast"&&x.trigger("next-slide",[C.attr("data-count"),i,w]);h.lazy&&k(w?0:-2);w&&C.detach().insertBefore(E);C.removeClass("hide");f($.proxy(A,null,w,E,C,D.first()))};v.last().removeClass("hide");u();!v.length&&h.defaultSlide&&$("ul:first",this).append(h.defaultSlide);k(-1);if(v.length<2){return}h.nav&&x.append(h.nav.next.clone().addClass("next"),h.nav.prev.clone().addClass("prev"));v.each(function(){$(this).attr("data-count",v.length-$(this).index())})&&h.counter&&x.append($("<div>").addClass("counter").html("<span>1</span>/"+v.length));if(l){l.push($(h.navigator.item).addClass(h.navigator.classes.item+" "+h.navigator.classes.active)[0].outerHTML);for(y=1;y<v.length;y=y+1){l.push($(h.navigator.item).addClass(h.navigator.classes.item)[0].outerHTML)}j=$(h.navigator.cont).html(l.join("")).addClass(h.navigator.classes.cont);x.append(j).on("next-slide",function(C,w,i){!(i==="fast"||i==="navigator")&&j.find(".nav-item").removeClass(h.navigator.classes.active).eq(w-1).addClass(h.navigator.classes.active)});z=function(){var D=$(this).index(),i=$("."+h.navigator.classes.active,j).index(),C=D<i,E=Math.abs(i-D)-1,F=function(){if(E<=0){x.off("slide-done",F);m.isForwarding=false;r.anim=h.times.anim;v.css({transitionTimingFunction:"initial"});return}E--;E===0&&(r.anim=Math.max(r.anim,h.times.last));n(+C,E===0&&"navigator"||"fast")},w=function(){x.on("slide-done",F);if(E>0){r.anim=h.times.anim/(E+1);v.css({transitionTimingFunction:"linear"})}n(+C,E===0&&"navigator"||"fast")};if(D===i){return}j.find(".nav-item").removeClass(h.navigator.classes.active).eq(D).addClass(h.navigator.classes.active);m.isForwarding=true;m.isAuto&&x.trigger("stop");m.isAnimating&&x.one("slide-done",w)||w()};x.on("click",".nav-item",z)}!h.animation.css&&x.addClass("no-transition");p=$(".prev, .next",x);p.on("click",function(w,C){var i=$(this).hasClass("prev");if($(this).hasClass("off")){return}p.addClass("off");n(+i,C||i&&"prev"||"next")});x.on("slide-done",function(){h.counter&&$(".counter span",x).text($("ul:first > li:last",x).attr("data-count"));p.removeClass("off")}).on("animation-changed",u);$.isNumeric(h.times.next)&&(function(){var C=0,i={hidden:"visibilitychange",msHidden:"msvisibilitychange",webkitHidden:"webkitvisibilitychange"},D=typeof document.hidden!=="undefined"&&"hidden"||typeof document.msHidden!=="undefined"&&"msHidden"||typeof document.webkitHidden!=="undefined"&&"webkitHidden",w=function(){clearInterval(C);m.isAuto=false},E=function(){w();!m.permStop&&!m.isForwarding&&(m.isAuto=true)&&(C=setInterval($.proxy(n,null,0,"auto"),h.times.next))};c(x)&&E();x.hover(w,E).on("swipeleft swiperight mousedown stop",w).on("start",E).on("perm-stop",function(){m.permStop=true;w()});$(document).on(i[D],function(){document[D]?w():E()});g.on("focus",E).on("blur",w).on(h.scroll,c(x)?E:w)})();h.nav.keyboard&&(function(){var i={37:1,39:0};$(document).on("keydown",function(w){typeof i[w.which]!=="undefined"&&c(x)&&!m.isAnimating&&x.trigger("stop")&&n(i[w.which],"keyboard")})})()})};